# ğŸ› ï¸ The Council - å¼€å‘è§„çº¦ (v0.15.0)

> **åŸåˆ™**: åŠ¡æ±‚å®æ•ˆ | å‰ç«¯é©±åŠ¨ | æ¨¡æ‹Ÿä¼˜å…ˆ | æ¸è¿›äº¤ä»˜ | TDD

## 1. æ¶æ„ (Architecture)

| é¢†åŸŸ | æŠ€æœ¯æ ˆ                | ç›®å½•                            |
| :--- | :-------------------- | :------------------------------ |
| App  | React SPA             | `frontend/src/`                 |
| API  | Go/Gin/WebSocket      | `cmd/council/`, `internal/api/` |
| Core | Workflow Engine       | `internal/core/`                |
| Data | PostgreSQL + pgvector | `internal/infrastructure/db/`   |

**äº¤ä»˜**: Atomic Commits â†’ Quality Gates (Lint + Test) â†’ Update `docs/development_plan.md`

## 2. ç¼–ç è§„çº¦ (Standards)

| ç»´åº¦ | Go                      | React/TS               |
| :--- | :---------------------- | :--------------------- |
| é£æ ¼ | `gofmt` + `goimports`   | `Prettier` + `ESLint`  |
| Lint | `golangci-lint` (CI)    | No `any`, Strict       |
| å‘½å | `snake_case` (JSON)     | `camelCase` (Props)    |
| é”™è¯¯ | `fmt.Errorf("...: %w")` | Error Boundary + Toast |
| å¹¶å‘ | å¿…é¡»ä¼  `ctx`            | `useEffect` cleanup    |

## 3. API & Data

- **ç±»å‹åŒæ­¥**: Go Struct â†” TS (`tygo`)ï¼Œç¦æ­¢æ‰‹åŠ¨ç»´æŠ¤
- **Migrations**: `golang-migrate` (`YYYYMMDDHHMMSS_name.up.sql`)

## 4. å‰åç«¯åä½œ ğŸ†•

> åŸºäº 2025-12-21 WebSocket è°ƒè¯•ç»éªŒæ€»ç»“

| è§„åˆ™              | è¯´æ˜                                     |
| :---------------- | :--------------------------------------- |
| **JSON å­—æ®µå‘½å** | å‰åç«¯å¿…é¡»**å®Œå…¨ç›¸åŒ**ï¼Œä¼˜å…ˆé‡‡ç”¨å‰ç«¯æƒ¯ä¾‹ |
| **ç±»å‹åŒæ­¥**      | `tygo` è‡ªåŠ¨ç”Ÿæˆï¼Œç¦æ­¢æ‰‹åŠ¨ç»´æŠ¤            |
| **æµ‹è¯•è¦†ç›–**      | WebSocket æ¶ˆæ¯éœ€**ç«¯åˆ°ç«¯æ ¼å¼éªŒè¯**       |

### 4.2 ID è¯­ä¹‰è§„èŒƒ

| ID ç±»å‹    | å‘½åè§„èŒƒ        | ç¤ºä¾‹                         |
| :--------- | :-------------- | :--------------------------- |
| æ•°æ®åº“ä¸»é”® | `{entity}_uuid` | `agent_uuid`, `session_uuid` |
| é€»è¾‘æ ‡è¯†ç¬¦ | `{context}_id`  | `node_id`, `workflow_id`     |

**ç¦æ­¢æ··ç”¨**: åœ¨äº‹ä»¶/æ¶ˆæ¯ä¸­ï¼Œå¿…é¡»ä½¿ç”¨é€»è¾‘æ ‡è¯†ç¬¦ï¼Œè€Œéæ•°æ®åº“ UUIDã€‚

### 4.3 æ•°æ®ä¼ é€’å®Œæ•´æ€§

- **ç±»å‹è®¾è®¡**: å¿…é¡»åŒ…å« UI æ¸²æŸ“æ‰€éœ€çš„å…¨éƒ¨å­—æ®µï¼ˆå¦‚ `name`, `type`ï¼‰
- **ä¿¡æ¯ä¼ é€’**: ç¦æ­¢åœ¨ä¸­é—´å±‚ä¸¢å¼ƒä¸Šæ¸¸ä¼ å…¥çš„æœ‰æ•ˆä¿¡æ¯

## 5. é»˜è®¤å€¼ä¸é…ç½® ğŸ†•

| è§„åˆ™           | è¯´æ˜                                     |
| :------------- | :--------------------------------------- |
| **ç¦æ­¢ç¡¬ç¼–ç ** | æ‰€æœ‰é»˜è®¤å€¼å¿…é¡»é€šè¿‡é…ç½®æ–‡ä»¶æˆ–å·¥å‚æ–¹æ³•è·å– |
| **é™çº§ä¸€è‡´æ€§** | é™çº§é€»è¾‘å¿…é¡»ä¸å½“å‰ Provider/ç¯å¢ƒå…¼å®¹     |
| **é…ç½®ä¼˜å…ˆçº§** | ç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > ä»£ç å†…é»˜è®¤å€¼       |

**ç¤ºä¾‹**:
```go
// âŒ ç¦æ­¢
if model == "" { model = "gpt-4" }

// âœ… æ­£ç¡®
if model == "" { model = registry.GetDefaultModel() }
```

## 6. AI & Prompt

- **å­˜æ”¾**: `/prompts/*.md`ï¼Œç¦æ­¢ Hardcode
- **æ¨¡æ¿**: `{{.Context}}`, `{{.UserQuery}}`
- **å®‰å…¨**: Context Overflow è‡ªåŠ¨æˆªæ–­

## 7. æµ‹è¯• (QA)

- **å‘½ä»¤**: `make test`ï¼Œä¸¥ç¦ `go test`
- **è¦†ç›–**: Core **100%**
- **Mock**: ç¦æ­¢çœŸå® DB/LLM
- **ç«¯åˆ°ç«¯** ğŸ†•: WebSocket æ¶ˆæ¯æ ¼å¼éœ€è·¨å‰åç«¯éªŒè¯
