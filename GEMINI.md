# ğŸ› ï¸ The Council - å¼€å‘è§„çº¦ (v0.15.1)

> **åŸåˆ™**: åŠ¡æ±‚å®æ•ˆ | å‰ç«¯é©±åŠ¨ | æ¨¡æ‹Ÿä¼˜å…ˆ | æ¸è¿›äº¤ä»˜ | TDD

## 1. æ¶æ„ (Architecture)

| é¢†åŸŸ | æŠ€æœ¯æ ˆ                | ç›®å½•                            |
| :--- | :-------------------- | :------------------------------ |
| App  | React SPA             | `frontend/src/`                 |
| API  | Go/Gin/WebSocket      | `cmd/council/`, `internal/api/` |
| Core | Workflow Engine       | `internal/core/`                |
| Data | PostgreSQL + pgvector | `internal/infrastructure/db/`   |

**äº¤ä»˜**: Atomic Commits â†’ Quality Gates (Lint + Test) â†’ Update `docs/development_plan.md`

## 2. ç¼–ç è§„çº¦ (Standards)

| ç»´åº¦ | Go                      | React/TS               |
| :--- | :---------------------- | :--------------------- |
| é£æ ¼ | `gofmt` + `goimports`   | `Prettier` + `ESLint`  |
| Lint | `golangci-lint` (CI)    | No `any`, Strict       |
| å‘½å | `snake_case` (JSON)     | `camelCase` (Props)    |
| é”™è¯¯ | `fmt.Errorf("...: %w")` | Error Boundary + Toast |
| å¹¶å‘ | å¿…é¡»ä¼  `ctx`            | `useEffect` cleanup    |

## 3. API & Data

- **ç±»å‹åŒæ­¥**: Go Struct â†” TS (`tygo`)ï¼Œç¦æ­¢æ‰‹åŠ¨ç»´æŠ¤
- **å·¥å…·é©±åŠ¨**: å¿…é¡»ä¾èµ–è‡ªåŠ¨åŒ–å·¥å…·ç”Ÿæˆå¥‘çº¦ï¼ˆTygo/OpenAPIï¼‰ï¼Œ**å·¥å…·ä¸ä»…ä»…æ˜¯ç”Ÿæˆå™¨ï¼Œæ›´æ˜¯å¼ºåˆ¶ä¸€è‡´æ€§çš„ç›‘å·¥**ã€‚ä¸¥ç¦æ‰‹å†™ç±»å‹å®šä¹‰ä»¥â€œæ©ç›–â€ä¸ä¸€è‡´ã€‚
- **Migrations**: `golang-migrate` (`YYYYMMDDHHMMSS_name.up.sql`)

## 4. å‰åç«¯åä½œ ğŸ†•


| è§„åˆ™              | è¯´æ˜                                     |
| :---------------- | :--------------------------------------- |
| **JSON å­—æ®µå‘½å** | å‰åç«¯å¿…é¡»**å®Œå…¨ç›¸åŒ**ï¼Œä¼˜å…ˆé‡‡ç”¨å‰ç«¯æƒ¯ä¾‹ |
| **ç±»å‹åŒæ­¥**      | `tygo` è‡ªåŠ¨ç”Ÿæˆï¼Œç¦æ­¢æ‰‹åŠ¨ç»´æŠ¤            |
| **æµ‹è¯•è¦†ç›–**      | WebSocket æ¶ˆæ¯éœ€**ç«¯åˆ°ç«¯æ ¼å¼éªŒè¯**       |

### 4.2 ID è¯­ä¹‰è§„èŒƒ (ID Naming)

| ID ç±»å‹    | åç¼€è§„èŒƒ | ç¤ºä¾‹                        | è¯­ä¹‰                                  |
| :--------- | :------- | :-------------------------- | :------------------------------------ |
| **ä¸»é”®**   | `_uuid`  | `user_uuid`, `session_uuid` | Database Primary Key (UUID), å…¨å±€å”¯ä¸€ |
| **é€»è¾‘ID** | `_id`    | `node_id`, `provider_id`    | Logic Identifier, å±€éƒ¨/ä¸Šä¸‹æ–‡å”¯ä¸€     |

**ç¦æ­¢**: ä½¿ç”¨é€šç”¨ `id` / `uuid` å­—æ®µï¼ˆReactFlow ç­‰ç¬¬ä¸‰æ–¹åº“å¼ºåˆ¶è¦æ±‚é™¤å¤–ï¼Œéœ€åœ¨è½¬æ¢å±‚å¤„ç†ï¼‰ã€‚

### 4.3 æ•°æ®ä¼ é€’ (Data Contract)

- **åŒæ„**: å‰åç«¯å­—æ®µåå¿…é¡»**å®Œå…¨ä¸€è‡´**ï¼Œç¦æ­¢æ‰‹åŠ¨ Map é‡å‘½åã€‚
- **ä¼ é€’**: ç¦æ­¢åœ¨ä¸­é—´å±‚ä¸¢å¼ƒä¸Šæ¸¸å­—æ®µï¼ŒDTO å¿…é¡»åŒ…å«æ¶ˆè´¹è€…æ‰€éœ€å…¨éƒ¨ä¿¡æ¯ã€‚

## 5. é»˜è®¤å€¼ä¸é…ç½® ğŸ†•

| è§„åˆ™           | è¯´æ˜                                     |
| :------------- | :--------------------------------------- |
| **ç¦æ­¢ç¡¬ç¼–ç ** | æ‰€æœ‰é»˜è®¤å€¼å¿…é¡»é€šè¿‡é…ç½®æ–‡ä»¶æˆ–å·¥å‚æ–¹æ³•è·å– |
| **é™çº§ä¸€è‡´æ€§** | é™çº§é€»è¾‘å¿…é¡»ä¸å½“å‰ Provider/ç¯å¢ƒå…¼å®¹     |
| **é…ç½®ä¼˜å…ˆçº§** | ç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > ä»£ç å†…é»˜è®¤å€¼       |


## 6. AI & Prompt

- **å­˜æ”¾**: `/prompts/*.md`ï¼Œç¦æ­¢ Hardcode
- **æ¨¡æ¿**: `{{.Context}}`, `{{.UserQuery}}`
- **å®‰å…¨**: Context Overflow è‡ªåŠ¨æˆªæ–­

## 7. æµ‹è¯• (QA)

- **å‘½ä»¤**: `make test`ï¼Œä¸¥ç¦ `go test`
- **è¦†ç›–**: Core **100%**
- **Mock**: ç¦æ­¢çœŸå® DB/LLM
- **ç«¯åˆ°ç«¯** ğŸ†•: WebSocket æ¶ˆæ¯æ ¼å¼éœ€è·¨å‰åç«¯éªŒè¯
